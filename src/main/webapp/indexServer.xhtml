<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">
    <h:head>
        <title>World Events Tracker</title>
        <link rel="stylesheet" type="text/css" href="css/events.css"/>
        <script src="script/datetime.js"></script>
        <script>
		function startTime()
		{
			updateServerTimes();
			t=setTimeout(function(){startTime()},1000);
		}
		</script>
    </h:head>
    <h:body onload="startTime()">
    	<p:layout fullPage="true">
    	<p:ajax event="resize" listener="#{checkboxBean.handleResize}"/>
    	<p:ajax event="toggle" listener="#{checkboxBean.handleToggle}"/>
    	<p:layoutUnit id="top" position="north" size="50">

            <p:menubar>
                <p:submenu label="Display Type" icon="ui-icon-document">
                    <p:menuitem value="By Event" url="indexAR.jsf" />
                    <p:menuitem value="By Server" url="#" />
                </p:submenu>
            </p:menubar>
        </p:layoutUnit>
    	<p:layoutUnit position="center" header="Events" resizable="true" closable="false" collapsible="false">       
        <h:form id="form">
        	<p:poll interval="15"   
            	listener="#{ajaxPollBean.updateEventServer(serv1Table, serv2Table, serv3Table)}" 
            	widgetVar="poll" autoStart="true"/>
            	
        	<p:dashboard id="board" model="#{serverDashboardBean.model}">
        		 <p:ajax event="reorder"/>
        		 <p:panel id="sorPanel" header="Sanctum of Rall (Home)" toggleable="true" collapsed="#{serverDashboardBean.sorCollapsed}">
        		 	<p:ajax event="toggle" listener="#{serverDashboardBean.handleSorToggle}"/>
        		 	<p:dataTable  binding="#{serv1Table}" var="status" value="#{dragonBean.sorStatus}" styleClass="hide-column-names" rowStyleClass="#{status.color}">
        		 		<p:column>  
				            <h:panelGroup id="eventCol">#{status.event}</h:panelGroup>  
				        </p:column>  
				        <p:column>  
				            <h:panelGroup id="statusCol">#{status.status}</h:panelGroup>  
				        </p:column>
				        <p:column styleClass="dateColumn">  
				            <h:panelGroup id="dateCol">#{status.date}</h:panelGroup>
				        </p:column>
        		 	</p:dataTable>
        		 </p:panel>
        		 
        		 <p:panel id="fcPanel" header="Ferguson's Crossing" toggleable="true" collapsed="#{serverDashboardBean.fcCollapsed}">
        		 	<p:ajax event="toggle" listener="#{serverDashboardBean.handleFcToggle}"/>
        		 	<p:dataTable binding="#{serv2Table}" var="status" value="#{dragonBean.fcStatus}" styleClass="hide-column-names" rowStyleClass="#{status.color}">
        		 		<p:column>  
				            <h:panelGroup id="eventCol">#{status.event}</h:panelGroup>  
				        </p:column>  
				        <p:column>  
				            <h:panelGroup id="statusCol">#{status.status}</h:panelGroup>  
				        </p:column>
				        <p:column styleClass="dateColumn">  
				            <h:panelGroup  id="dateCol">#{status.date}</h:panelGroup>
				        </p:column>
        		 	</p:dataTable>
        		 </p:panel>
        		 
        		 <p:panel id="etPanel" header="Eredon Terrace" toggleable="true" collapsed="#{serverDashboardBean.etCollapsed}">
        		 	<p:ajax event="toggle" listener="#{serverDashboardBean.handleEtToggle}"/>
        		 	<p:dataTable binding="#{serv3Table}" var="status" value="#{dragonBean.etStatus}" styleClass="hide-column-names" rowStyleClass="#{status.color}">
        		 		<p:column>  
				            <h:panelGroup id="eventCol">#{status.event}</h:panelGroup>  
				        </p:column>  
				        <p:column>  
				            <h:panelGroup id="statusCol">#{status.status}</h:panelGroup>  
				        </p:column>
				        <p:column styleClass="dateColumn">  
				            <h:panelGroup id="dateCol">#{status.date}</h:panelGroup>
				        </p:column>
        		 	</p:dataTable>
        		 </p:panel>
        	</p:dashboard>
        </h:form>
        </p:layoutUnit>
        <p:layoutUnit id="bottom" position="south" size="200" resizable="true">
            <ui:include src="eventWindow.xhtml"></ui:include>
        </p:layoutUnit>
        <p:layoutUnit id="east" position="east" header="Checkboxes" size="#{checkboxBean.eastSize}" collapsed="#{checkboxBean.eastCollapsed}" 
        	closable="false" collapsible="true" resizable="true">
        	<h:form id="checkboxes">
        		<p:selectManyCheckbox value="#{checkboxBean.selectedEvents}"  
		            layout="pageDirection" id="smcb">  
		            <f:selectItems value="#{checkboxBean.events}" />
		            <p:ajax listener="#{checkboxBean.handleCheckbox(serv1Table, serv2Table, serv3Table)}"/> 
		        </p:selectManyCheckbox>
		        <p:commandButton value="Clear All" update="smcb" id="ajax"  
             			actionListener="#{checkboxBean.clearAll(serv1Table, serv2Table, serv3Table)}">
		        </p:commandButton>
        	</h:form>
        </p:layoutUnit>
        </p:layout>  
    </h:body>
</html>